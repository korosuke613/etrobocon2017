<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ETrobocon2017: str/googletest/googletest/docs/V1_7_Primer.md ソースファイル</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ETrobocon2017
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- 構築: Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'検索');
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('../../',true,false,'search.php','検索');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('de/dea/_v1__7___primer_8md.html','../../');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">str/googletest/googletest/docs/V1_7_Primer.md</div>  </div>
</div><!--header-->
<div class="contents">
<a href="../../de/dea/_v1__7___primer_8md.html">[詳解]</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;# Introduction: Why Google C++ Testing Framework? #</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;_Google C++ Testing Framework_ helps you write better C++ tests.</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;No matter whether you work on Linux, Windows, or a Mac, if you write C++ code,</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;Google Test can help you.</div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;So what makes a good test, and how does Google C++ Testing Framework fit in? We believe:</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;  1. Tests should be _independent_ and _repeatable_. It&#39;s a pain to debug a test that succeeds or fails as a result of other tests.  Google C++ Testing Framework isolates the tests by running each of them on a different object. When a test fails, Google C++ Testing Framework allows you to run it in isolation for quick debugging.</div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;  1. Tests should be well _organized_ and reflect the structure of the tested code.  Google C++ Testing Framework groups related tests into test cases that can share data and subroutines. This common pattern is easy to recognize and makes tests easy to maintain. Such consistency is especially helpful when people switch projects and start to work on a new code base.</div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;  1. Tests should be _portable_ and _reusable_. The open-source community has a lot of code that is platform-neutral, its tests should also be platform-neutral.  Google C++ Testing Framework works on different OSes, with different compilers (gcc, MSVC, and others), with or without exceptions, so Google C++ Testing Framework tests can easily work with a variety of configurations.  (Note that the current release only contains build scripts for Linux - we are actively working on scripts for other platforms.)</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;  1. When tests fail, they should provide as much _information_ about the problem as possible. Google C++ Testing Framework doesn&#39;t stop at the first test failure. Instead, it only stops the current test and continues with the next. You can also set up tests that report non-fatal failures after which the current test continues. Thus, you can detect and fix multiple bugs in a single run-edit-compile cycle.</div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;  1. The testing framework should liberate test writers from housekeeping chores and let them focus on the test _content_.  Google C++ Testing Framework automatically keeps track of all tests defined, and doesn&#39;t require the user to enumerate them in order to run them.</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;  1. Tests should be _fast_. With Google C++ Testing Framework, you can reuse shared resources across tests and pay for the set-up/tear-down only once, without making tests depend on each other.</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;</div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;Since Google C++ Testing Framework is based on the popular xUnit</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;architecture, you&#39;ll feel right at home if you&#39;ve used JUnit or PyUnit before.</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;If not, it will take you about 10 minutes to learn the basics and get started.</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;So let&#39;s go!</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;_Note:_ We sometimes refer to Google C++ Testing Framework informally</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;as _Google Test_.</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;# Setting up a New Test Project #</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;To write a test program using Google Test, you need to compile Google</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;Test into a library and link your test with it.  We provide build</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;files for some popular build systems: `msvc/` for Visual Studio,</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;`xcode/` for Mac Xcode, `make/` for GNU make, `codegear/` for Borland</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;C++ Builder, and the autotools script (deprecated) and</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;`CMakeLists.txt` for CMake (recommended) in the Google Test root</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;directory.  If your build system is not on this list, you can take a</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;look at `make/Makefile` to learn how Google Test should be compiled</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;(basically you want to compile `src/gtest-all.cc` with `GTEST_ROOT`</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;and `GTEST_ROOT/include` in the header search path, where `GTEST_ROOT`</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;is the Google Test root directory).</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;Once you are able to compile the Google Test library, you should</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;create a project or build target for your test program.  Make sure you</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;have `GTEST_ROOT/include` in the header search path so that the</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;compiler can find `&quot;gtest/gtest.h&quot;` when compiling your test.  Set up</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;your test project to link with the Google Test library (for example,</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;in Visual Studio, this is done by adding a dependency on</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;`gtest.vcproj`).</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;If you still have questions, take a look at how Google Test&#39;s own</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;tests are built and use them as examples.</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;# Basic Concepts #</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;When using Google Test, you start by writing _assertions_, which are statements</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;that check whether a condition is true. An assertion&#39;s result can be _success_,</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;_nonfatal failure_, or _fatal failure_. If a fatal failure occurs, it aborts</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;the current function; otherwise the program continues normally.</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;_Tests_ use assertions to verify the tested code&#39;s behavior. If a test crashes</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;or has a failed assertion, then it _fails_; otherwise it _succeeds_.</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;A _test case_ contains one or many tests. You should group your tests into test</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;cases that reflect the structure of the tested code. When multiple tests in a</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;test case need to share common objects and subroutines, you can put them into a</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;_test fixture_ class.</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;A _test program_ can contain multiple test cases.</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;We&#39;ll now explain how to write a test program, starting at the individual</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;assertion level and building up to tests and test cases.</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;# Assertions #</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;Google Test assertions are macros that resemble function calls. You test a</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;class or function by making assertions about its behavior. When an assertion</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;fails, Google Test prints the assertion&#39;s source file and line number location,</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;along with a failure message. You may also supply a custom failure message</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;which will be appended to Google Test&#39;s message.</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;The assertions come in pairs that test the same thing but have different</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;effects on the current function. `ASSERT_*` versions generate fatal failures</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;when they fail, and **abort the current function**. `EXPECT_*` versions generate</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;nonfatal failures, which don&#39;t abort the current function. Usually `EXPECT_*`</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;are preferred, as they allow more than one failures to be reported in a test.</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;However, you should use `ASSERT_*` if it doesn&#39;t make sense to continue when</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;the assertion in question fails.</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;Since a failed `ASSERT_*` returns from the current function immediately,</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;possibly skipping clean-up code that comes after it, it may cause a space leak.</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;Depending on the nature of the leak, it may or may not be worth fixing - so</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;keep this in mind if you get a heap checker error in addition to assertion</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;errors.</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;To provide a custom failure message, simply stream it into the macro using the</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;`&lt;&lt;` operator, or a sequence of such operators. An example:</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;```</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;ASSERT_EQ(x.size(), y.size()) &lt;&lt; &quot;Vectors x and y are of unequal length&quot;;</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;for (int i = 0; i &lt; x.size(); ++i) {</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  EXPECT_EQ(x[i], y[i]) &lt;&lt; &quot;Vectors x and y differ at index &quot; &lt;&lt; i;</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;}</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;```</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;Anything that can be streamed to an `ostream` can be streamed to an assertion</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;macro--in particular, C strings and `string` objects. If a wide string</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;(`wchar_t*`, `TCHAR*` in `UNICODE` mode on Windows, or `std::wstring`) is</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;streamed to an assertion, it will be translated to UTF-8 when printed.</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;## Basic Assertions ##</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;These assertions do basic true/false condition testing.</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;| **Fatal assertion** | **Nonfatal assertion** | **Verifies** |</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;|:--------------------|:-----------------------|:-------------|</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;| `ASSERT_TRUE(`_condition_`)`;  | `EXPECT_TRUE(`_condition_`)`;   | _condition_ is true |</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;| `ASSERT_FALSE(`_condition_`)`; | `EXPECT_FALSE(`_condition_`)`;  | _condition_ is false |</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;Remember, when they fail, `ASSERT_*` yields a fatal failure and</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;returns from the current function, while `EXPECT_*` yields a nonfatal</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;failure, allowing the function to continue running. In either case, an</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;assertion failure means its containing test fails.</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;_Availability_: Linux, Windows, Mac.</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;## Binary Comparison ##</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;This section describes assertions that compare two values.</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;| **Fatal assertion** | **Nonfatal assertion** | **Verifies** |</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;|:--------------------|:-----------------------|:-------------|</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;|`ASSERT_EQ(`_expected_`, `_actual_`);`|`EXPECT_EQ(`_expected_`, `_actual_`);`| _expected_ `==` _actual_ |</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;|`ASSERT_NE(`_val1_`, `_val2_`);`      |`EXPECT_NE(`_val1_`, `_val2_`);`      | _val1_ `!=` _val2_ |</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;|`ASSERT_LT(`_val1_`, `_val2_`);`      |`EXPECT_LT(`_val1_`, `_val2_`);`      | _val1_ `&lt;` _val2_ |</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;|`ASSERT_LE(`_val1_`, `_val2_`);`      |`EXPECT_LE(`_val1_`, `_val2_`);`      | _val1_ `&lt;=` _val2_ |</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;|`ASSERT_GT(`_val1_`, `_val2_`);`      |`EXPECT_GT(`_val1_`, `_val2_`);`      | _val1_ `&gt;` _val2_ |</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;|`ASSERT_GE(`_val1_`, `_val2_`);`      |`EXPECT_GE(`_val1_`, `_val2_`);`      | _val1_ `&gt;=` _val2_ |</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;In the event of a failure, Google Test prints both _val1_ and _val2_</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;. In `ASSERT_EQ*` and `EXPECT_EQ*` (and all other equality assertions</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;we&#39;ll introduce later), you should put the expression you want to test</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;in the position of _actual_, and put its expected value in _expected_,</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;as Google Test&#39;s failure messages are optimized for this convention.</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;Value arguments must be comparable by the assertion&#39;s comparison</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;operator or you&#39;ll get a compiler error.  We used to require the</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;arguments to support the `&lt;&lt;` operator for streaming to an `ostream`,</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;but it&#39;s no longer necessary since v1.6.0 (if `&lt;&lt;` is supported, it</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;will be called to print the arguments when the assertion fails;</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;otherwise Google Test will attempt to print them in the best way it</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;can. For more details and how to customize the printing of the</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;arguments, see this Google Mock [recipe](../../googlemock/docs/CookBook.md#teaching-google-mock-how-to-print-your-values).).</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;These assertions can work with a user-defined type, but only if you define the</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;corresponding comparison operator (e.g. `==`, `&lt;`, etc).  If the corresponding</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;operator is defined, prefer using the `ASSERT_*()` macros because they will</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;print out not only the result of the comparison, but the two operands as well.</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;Arguments are always evaluated exactly once. Therefore, it&#39;s OK for the</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;arguments to have side effects. However, as with any ordinary C/C++ function,</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;the arguments&#39; evaluation order is undefined (i.e. the compiler is free to</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;choose any order) and your code should not depend on any particular argument</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;evaluation order.</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;`ASSERT_EQ()` does pointer equality on pointers. If used on two C strings, it</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;tests if they are in the same memory location, not if they have the same value.</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;Therefore, if you want to compare C strings (e.g. `const char*`) by value, use</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;`ASSERT_STREQ()` , which will be described later on. In particular, to assert</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;that a C string is `NULL`, use `ASSERT_STREQ(NULL, c_string)` . However, to</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;compare two `string` objects, you should use `ASSERT_EQ`.</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;Macros in this section work with both narrow and wide string objects (`string`</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;and `wstring`).</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;_Availability_: Linux, Windows, Mac.</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;## String Comparison ##</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;The assertions in this group compare two **C strings**. If you want to compare</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;two `string` objects, use `EXPECT_EQ`, `EXPECT_NE`, and etc instead.</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;| **Fatal assertion** | **Nonfatal assertion** | **Verifies** |</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;|:--------------------|:-----------------------|:-------------|</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;| `ASSERT_STREQ(`_expected\_str_`, `_actual\_str_`);`    | `EXPECT_STREQ(`_expected\_str_`, `_actual\_str_`);`     | the two C strings have the same content |</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;| `ASSERT_STRNE(`_str1_`, `_str2_`);`    | `EXPECT_STRNE(`_str1_`, `_str2_`);`     | the two C strings have different content |</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;| `ASSERT_STRCASEEQ(`_expected\_str_`, `_actual\_str_`);`| `EXPECT_STRCASEEQ(`_expected\_str_`, `_actual\_str_`);` | the two C strings have the same content, ignoring case |</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;| `ASSERT_STRCASENE(`_str1_`, `_str2_`);`| `EXPECT_STRCASENE(`_str1_`, `_str2_`);` | the two C strings have different content, ignoring case |</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;Note that &quot;CASE&quot; in an assertion name means that case is ignored.</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;`*STREQ*` and `*STRNE*` also accept wide C strings (`wchar_t*`). If a</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;comparison of two wide strings fails, their values will be printed as UTF-8</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;narrow strings.</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;A `NULL` pointer and an empty string are considered _different_.</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;_Availability_: Linux, Windows, Mac.</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;See also: For more string comparison tricks (substring, prefix, suffix, and</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;regular expression matching, for example), see the [Advanced Google Test Guide](V1_7_AdvancedGuide.md).</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;# Simple Tests #</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;To create a test:</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;  1. Use the `TEST()` macro to define and name a test function, These are ordinary C++ functions that don&#39;t return a value.</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;  1. In this function, along with any valid C++ statements you want to include, use the various Google Test assertions to check values.</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;  1. The test&#39;s result is determined by the assertions; if any assertion in the test fails (either fatally or non-fatally), or if the test crashes, the entire test fails. Otherwise, it succeeds.</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;```</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;TEST(test_case_name, test_name) {</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160; ... test body ...</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;}</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;```</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;`TEST()` arguments go from general to specific. The _first_ argument is the</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;name of the test case, and the _second_ argument is the test&#39;s name within the</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;test case. Both names must be valid C++ identifiers, and they should not contain underscore (`_`). A test&#39;s _full name_ consists of its containing test case and its</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;individual name. Tests from different test cases can have the same individual</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;name.</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;For example, let&#39;s take a simple integer function:</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;```</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;int Factorial(int n); // Returns the factorial of n</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;```</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;A test case for this function might look like:</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;```</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;// Tests factorial of 0.</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;TEST(FactorialTest, HandlesZeroInput) {</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;  EXPECT_EQ(1, Factorial(0));</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;}</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;// Tests factorial of positive numbers.</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;TEST(FactorialTest, HandlesPositiveInput) {</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;  EXPECT_EQ(1, Factorial(1));</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;  EXPECT_EQ(2, Factorial(2));</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;  EXPECT_EQ(6, Factorial(3));</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;  EXPECT_EQ(40320, Factorial(8));</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;}</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;```</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;Google Test groups the test results by test cases, so logically-related tests</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;should be in the same test case; in other words, the first argument to their</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;`TEST()` should be the same. In the above example, we have two tests,</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;`HandlesZeroInput` and `HandlesPositiveInput`, that belong to the same test</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;case `FactorialTest`.</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;_Availability_: Linux, Windows, Mac.</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;# Test Fixtures: Using the Same Data Configuration for Multiple Tests #</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;If you find yourself writing two or more tests that operate on similar data,</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;you can use a _test fixture_. It allows you to reuse the same configuration of</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;objects for several different tests.</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;To create a fixture, just:</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;  1. Derive a class from `::testing::Test` . Start its body with `protected:` or `public:` as we&#39;ll want to access fixture members from sub-classes.</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;  1. Inside the class, declare any objects you plan to use.</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;  1. If necessary, write a default constructor or `SetUp()` function to prepare the objects for each test. A common mistake is to spell `SetUp()` as `Setup()` with a small `u` - don&#39;t let that happen to you.</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;  1. If necessary, write a destructor or `TearDown()` function to release any resources you allocated in `SetUp()` . To learn when you should use the constructor/destructor and when you should use `SetUp()/TearDown()`, read this [FAQ entry](V1_7_FAQ.md#should-i-use-the-constructordestructor-of-the-test-fixture-or-the-set-uptear-down-function).</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;  1. If needed, define subroutines for your tests to share.</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;When using a fixture, use `TEST_F()` instead of `TEST()` as it allows you to</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;access objects and subroutines in the test fixture:</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;```</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;TEST_F(test_case_name, test_name) {</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160; ... test body ...</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;}</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;```</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;Like `TEST()`, the first argument is the test case name, but for `TEST_F()`</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;this must be the name of the test fixture class. You&#39;ve probably guessed: `_F`</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;is for fixture.</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;Unfortunately, the C++ macro system does not allow us to create a single macro</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;that can handle both types of tests. Using the wrong macro causes a compiler</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;error.</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;Also, you must first define a test fixture class before using it in a</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;`TEST_F()`, or you&#39;ll get the compiler error &quot;`virtual outside class</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;declaration`&quot;.</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;For each test defined with `TEST_F()`, Google Test will:</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;  1. Create a _fresh_ test fixture at runtime</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;  1. Immediately initialize it via `SetUp()` ,</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;  1. Run the test</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;  1. Clean up by calling `TearDown()`</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;  1. Delete the test fixture.  Note that different tests in the same test case have different test fixture objects, and Google Test always deletes a test fixture before it creates the next one. Google Test does not reuse the same test fixture for multiple tests. Any changes one test makes to the fixture do not affect other tests.</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;As an example, let&#39;s write tests for a FIFO queue class named `Queue`, which</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;has the following interface:</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;```</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;template &lt;typename E&gt; // E is the element type.</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;class Queue {</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160; public:</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;  Queue();</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;  void Enqueue(const E&amp; element);</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;  E* Dequeue(); // Returns NULL if the queue is empty.</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;  size_t size() const;</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;  ...</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;};</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;```</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;First, define a fixture class. By convention, you should give it the name</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;`FooTest` where `Foo` is the class being tested.</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;```</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;class QueueTest : public ::testing::Test {</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160; protected:</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;  virtual void SetUp() {</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    q1_.Enqueue(1);</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    q2_.Enqueue(2);</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    q2_.Enqueue(3);</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;  }</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;  // virtual void TearDown() {}</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;  Queue&lt;int&gt; q0_;</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;  Queue&lt;int&gt; q1_;</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;  Queue&lt;int&gt; q2_;</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;};</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;```</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;In this case, `TearDown()` is not needed since we don&#39;t have to clean up after</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;each test, other than what&#39;s already done by the destructor.</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;Now we&#39;ll write tests using `TEST_F()` and this fixture.</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;```</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;TEST_F(QueueTest, IsEmptyInitially) {</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;  EXPECT_EQ(0, q0_.size());</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;}</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;TEST_F(QueueTest, DequeueWorks) {</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;  int* n = q0_.Dequeue();</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;  EXPECT_EQ(NULL, n);</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;  n = q1_.Dequeue();</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;  ASSERT_TRUE(n != NULL);</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;  EXPECT_EQ(1, *n);</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;  EXPECT_EQ(0, q1_.size());</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;  delete n;</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;  n = q2_.Dequeue();</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;  ASSERT_TRUE(n != NULL);</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;  EXPECT_EQ(2, *n);</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;  EXPECT_EQ(1, q2_.size());</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;  delete n;</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;}</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;```</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;The above uses both `ASSERT_*` and `EXPECT_*` assertions. The rule of thumb is</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;to use `EXPECT_*` when you want the test to continue to reveal more errors</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;after the assertion failure, and use `ASSERT_*` when continuing after failure</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;doesn&#39;t make sense. For example, the second assertion in the `Dequeue` test is</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;`ASSERT_TRUE(n != NULL)`, as we need to dereference the pointer `n` later,</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;which would lead to a segfault when `n` is `NULL`.</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;When these tests run, the following happens:</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;  1. Google Test constructs a `QueueTest` object (let&#39;s call it `t1` ).</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;  1. `t1.SetUp()` initializes `t1` .</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;  1. The first test ( `IsEmptyInitially` ) runs on `t1` .</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;  1. `t1.TearDown()` cleans up after the test finishes.</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;  1. `t1` is destructed.</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;  1. The above steps are repeated on another `QueueTest` object, this time running the `DequeueWorks` test.</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;_Availability_: Linux, Windows, Mac.</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;_Note_: Google Test automatically saves all _Google Test_ flags when a test</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;object is constructed, and restores them when it is destructed.</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;# Invoking the Tests #</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;`TEST()` and `TEST_F()` implicitly register their tests with Google Test. So, unlike with many other C++ testing frameworks, you don&#39;t have to re-list all your defined tests in order to run them.</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;After defining your tests, you can run them with `RUN_ALL_TESTS()` , which returns `0` if all the tests are successful, or `1` otherwise. Note that `RUN_ALL_TESTS()` runs _all tests_ in your link unit -- they can be from different test cases, or even different source files.</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;When invoked, the `RUN_ALL_TESTS()` macro:</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;  1. Saves the state of all  Google Test flags.</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;  1. Creates a test fixture object for the first test.</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;  1. Initializes it via `SetUp()`.</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;  1. Runs the test on the fixture object.</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;  1. Cleans up the fixture via `TearDown()`.</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;  1. Deletes the fixture.</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;  1. Restores the state of all Google Test flags.</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;  1. Repeats the above steps for the next test, until all tests have run.</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;In addition, if the text fixture&#39;s constructor generates a fatal failure in</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;step 2, there is no point for step 3 - 5 and they are thus skipped. Similarly,</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;if step 3 generates a fatal failure, step 4 will be skipped.</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;_Important_: You must not ignore the return value of `RUN_ALL_TESTS()`, or `gcc`</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;will give you a compiler error. The rationale for this design is that the</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;automated testing service determines whether a test has passed based on its</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;exit code, not on its stdout/stderr output; thus your `main()` function must</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;return the value of `RUN_ALL_TESTS()`.</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;Also, you should call `RUN_ALL_TESTS()` only **once**. Calling it more than once</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;conflicts with some advanced Google Test features (e.g. thread-safe death</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;tests) and thus is not supported.</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;_Availability_: Linux, Windows, Mac.</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;# Writing the main() Function #</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;You can start from this boilerplate:</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;```</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;#include &quot;this/package/foo.h&quot;</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;#include &quot;gtest/gtest.h&quot;</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;namespace {</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;// The fixture for testing class Foo.</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;class FooTest : public ::testing::Test {</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160; protected:</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;  // You can remove any or all of the following functions if its body</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;  // is empty.</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;  FooTest() {</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    // You can do set-up work for each test here.</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;  }</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;  virtual ~FooTest() {</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    // You can do clean-up work that doesn&#39;t throw exceptions here.</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;  }</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;  // If the constructor and destructor are not enough for setting up</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;  // and cleaning up each test, you can define the following methods:</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;  virtual void SetUp() {</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    // Code here will be called immediately after the constructor (right</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    // before each test).</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;  }</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;  virtual void TearDown() {</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    // Code here will be called immediately after each test (right</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    // before the destructor).</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;  }</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;  // Objects declared here can be used by all tests in the test case for Foo.</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;};</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;// Tests that the Foo::Bar() method does Abc.</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;TEST_F(FooTest, MethodBarDoesAbc) {</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;  const string input_filepath = &quot;this/package/testdata/myinputfile.dat&quot;;</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;  const string output_filepath = &quot;this/package/testdata/myoutputfile.dat&quot;;</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;  Foo f;</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;  EXPECT_EQ(0, f.Bar(input_filepath, output_filepath));</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;}</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;// Tests that Foo does Xyz.</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;TEST_F(FooTest, DoesXyz) {</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;  // Exercises the Xyz feature of Foo.</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;}</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;}  // namespace</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;int main(int argc, char **argv) {</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;  ::testing::InitGoogleTest(&amp;argc, argv);</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;  return RUN_ALL_TESTS();</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;}</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;```</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;The `::testing::InitGoogleTest()` function parses the command line for Google</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;Test flags, and removes all recognized flags. This allows the user to control a</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;test program&#39;s behavior via various flags, which we&#39;ll cover in [AdvancedGuide](V1_7_AdvancedGuide.md).</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;You must call this function before calling `RUN_ALL_TESTS()`, or the flags</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;won&#39;t be properly initialized.</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;On Windows, `InitGoogleTest()` also works with wide strings, so it can be used</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;in programs compiled in `UNICODE` mode as well.</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;But maybe you think that writing all those main() functions is too much work? We agree with you completely and that&#39;s why Google Test provides a basic implementation of main(). If it fits your needs, then just link your test with gtest\_main library and you are good to go.</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;## Important note for Visual C++ users ##</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;If you put your tests into a library and your `main()` function is in a different library or in your .exe file, those tests will not run. The reason is a [bug](https://connect.microsoft.com/feedback/viewfeedback.aspx?FeedbackID=244410&amp;siteid=210) in Visual C++. When you define your tests, Google Test creates certain static objects to register them. These objects are not referenced from elsewhere but their constructors are still supposed to run. When Visual C++ linker sees that nothing in the library is referenced from other places it throws the library out. You have to reference your library with tests from your main program to keep the linker from discarding it. Here is how to do it. Somewhere in your library code declare a function:</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;```</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;__declspec(dllexport) int PullInMyLibrary() { return 0; }</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;```</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;If you put your tests in a static library (not DLL) then `__declspec(dllexport)` is not required. Now, in your main program, write a code that invokes that function:</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;```</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;int PullInMyLibrary();</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;static int dummy = PullInMyLibrary();</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;```</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;This will keep your tests referenced and will make them register themselves at startup.</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;In addition, if you define your tests in a static library, add `/OPT:NOREF` to your main program linker options. If you use MSVC++ IDE, go to your .exe project properties/Configuration Properties/Linker/Optimization and set References setting to `Keep Unreferenced Data (/OPT:NOREF)`. This will keep Visual C++ linker from discarding individual symbols generated by your tests from the final executable.</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;There is one more pitfall, though. If you use Google Test as a static library (that&#39;s how it is defined in gtest.vcproj) your tests must also reside in a static library. If you have to have them in a DLL, you _must_ change Google Test to build into a DLL as well. Otherwise your tests will not run correctly or will not run at all. The general conclusion here is: make your life easier - do not write your tests in libraries!</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;# Where to Go from Here #</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;Congratulations! You&#39;ve learned the Google Test basics. You can start writing</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;and running Google Test tests, read some [samples](V1_7_Samples.md), or continue with</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;[AdvancedGuide](V1_7_AdvancedGuide.md), which describes many more useful Google Test features.</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;# Known Limitations #</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;Google Test is designed to be thread-safe.  The implementation is</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;thread-safe on systems where the `pthreads` library is available.  It</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;is currently _unsafe_ to use Google Test assertions from two threads</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;concurrently on other systems (e.g. Windows).  In most tests this is</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;not an issue as usually the assertions are done in the main thread. If</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;you want to help, you can volunteer to implement the necessary</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;synchronization primitives in `gtest-port.h` for your platform.</div></div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../de/dea/_v1__7___primer_8md.html">V1_7_Primer.md</a></li>
    <li class="footer">構築:
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
